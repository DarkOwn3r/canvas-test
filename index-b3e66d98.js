(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function s(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(e){if(e.ep)return;e.ep=!0;const i=s(e);fetch(e.href,i)}})();class c{constructor(t=0,s=0){this.x=t,this.y=s}get len(){return Math.sqrt(this.x*this.x+this.y*this.y)}set len(t){const s=t/this.len;this.x*=s,this.y*=s}}class d{constructor(t,s){this.pos=new c,this.size=new c(t,s)}get left(){return this.pos.x-this.size.x/2}get right(){return this.pos.x+this.size.x/2}get top(){return this.pos.y-this.size.y/2}get bottom(){return this.pos.y+this.size.y/2}}class u extends d{constructor(){super(10,10),this.vel=new c}}class f extends d{constructor(){super(20,100),this.score=0}}class y{constructor(t){this._canvas=t,this._context=t.getContext("2d"),this.ball=new u,this.players=[new f,new f],this.players[0].pos.x=40,this.players[1].pos.x=this._canvas.width-40,this.players.forEach(e=>{e.pos.y=this._canvas.height/2});let s;const l=e=>{s&&this.update((e-s)/1e3),s=e,requestAnimationFrame(l)};l(),this.CHAR_PIXEL=10,this.CHARS=["111101101101111","010010010010010","111001111100111","111001111001111","101101111001001","111100111001111","111100111101111","111001001001001","111101111101111","111101111001111"].map(e=>{const i=document.createElement("canvas");i.height=this.CHAR_PIXEL*5,i.width=this.CHAR_PIXEL*5;const h=i.getContext("2d");return h.fillStyle="#fff",e.split("").forEach((a,r)=>{a==="1"&&h.fillRect(r%3*this.CHAR_PIXEL,(r/3|0)*this.CHAR_PIXEL,this.CHAR_PIXEL,this.CHAR_PIXEL)}),i}),this.reset()}collide(t,s){if(t.left<s.right&&t.right>s.left&&t.top<s.bottom&&t.bottom>s.top){const l=s.vel.len;s.vel.x=-s.vel.x,s.vel.y+=300*(Math.random()-.5),s.vel.len=l*1.05}}draw(){this._context.fillStyle="#000",this._context.fillRect(0,0,this._canvas.width,this._canvas.height),this._context.shadowColor="green",this._context.shadowBlur=20,this.drawRect(this.ball),this.players.forEach(t=>this.drawRect(t)),this.drawScore()}drawRect(t){this._context.fillStyle="#fff",this._context.fillRect(t.left,t.top,t.size.x,t.size.y)}drawScore(){const t=this._canvas.width/3,s=this.CHAR_PIXEL*4;this.players.forEach((l,e)=>{const i=l.score.toString().split(""),h=t*(e+1)-s*i.length/2+this.CHAR_PIXEL/2;i.forEach((a,r)=>{this._context.drawImage(this.CHARS[a|0],h+r*s,20)})})}reset(){this.ball.pos.x=this._canvas.width/2,this.ball.pos.y=this._canvas.height/2,this.ball.vel.x=0,this.ball.vel.y=0}start(){this.ball.vel.x===0&&this.ball.vel.y===0&&(this.ball.vel.x=300*(Math.random()>.5?1:-1),this.ball.vel.y=300*(Math.random()*2-1),this.ball.vel.len=500)}update(t){if(this.ball.pos.x+=this.ball.vel.x*t,this.ball.pos.y+=this.ball.vel.y*t,this.ball.left<0||this.ball.right>this._canvas.width){const s=this.ball.vel.x<0|0;this.players[s].score++,this.reset()}(this.ball.top<0||this.ball.bottom>this._canvas.height)&&(this.ball.vel.y=-this.ball.vel.y),this.players.forEach(s=>this.collide(s,this.ball)),this.players[1].pos.y=this.ball.pos.y+this.ball.vel.y/10,this.draw()}}const n=document.getElementById("pong"),p=new y(n);n.addEventListener("mousemove",o=>{const t=o.offsetY/o.target.getBoundingClientRect().height;p.players[0].pos.y=n.height*t});n.addEventListener("click",o=>{p.start()});
